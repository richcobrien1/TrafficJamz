# docker/api/Dockerfile.dev
# Development Dockerfile for the TrafficJamz API service

FROM node:18-alpine

# Set working directory
WORKDIR /app/backend

# Install dependencies for development (native modules, Python tooling)
RUN apk add --no-cache python3 py3-pip make g++ linux-headers

# Copy package files and install dependencies
COPY backend/package*.json ./
RUN npm install

# Copy source code
COPY backend/src ./src
COPY backend/config ./config
COPY shared ../shared

# Set environment variables
ENV NODE_ENV=development
ENV IS_LOCAL=true

# Expose API port
EXPOSE 3000

# Install nodemon for hot reloading
RUN npm install --save-dev nodemon

# Start the API service with hot reload
CMD ["npx", "nodemon", "--watch", "src", "src/api/server.js"]
