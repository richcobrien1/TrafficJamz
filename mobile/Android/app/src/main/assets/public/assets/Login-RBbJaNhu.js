import{r,u as E,a as P,b as I,j as e,L as y}from"./index-C_3tyMlA.js";import{C as T}from"./Container-BLhiYW-S.js";import{P as F,T as v,B as b}from"./Box-B7n4D01-.js";import{A as k}from"./Avatar-CTdIBAVi.js";import{A as B}from"./Grow-5OE428Pa.js";import{T as w}from"./TextField-BEOKNznX.js";import{B as D,C as W}from"./List-K2ODHGaJ.js";import{G as m}from"./Grid-CyXsRVxX.js";import{L as d}from"./Link-CDafOs9T.js";import"./mergeSlotProps-COfFLBTA.js";const K=()=>{var x;const[o,A]=r.useState(""),[s,C]=r.useState(""),[u,p]=r.useState(!1),[h,i]=r.useState(""),{login:S,isAuthenticated:f}=E(),n=P(),l=I();r.useEffect(()=>{var a;const t=(a=l.state)==null?void 0:a.from;t&&localStorage.setItem("redirectAfterLogin",t)},[l]);const g=r.useCallback(()=>{const t=localStorage.getItem("redirectAfterLogin");t&&t!=="/login"?(localStorage.removeItem("redirectAfterLogin"),n(t)):n("/dashboard")},[n]);r.useEffect(()=>{f&&g()},[f,g]);const L=async t=>{var a,j;if(t.preventDefault(),!o||!s){i("Please enter both email and password");return}try{i(""),p(!0),await S(o,s)}catch(c){console.error("Login error:",c),i(((j=(a=c.response)==null?void 0:a.data)==null?void 0:j.message)||c.message||"Failed to login. Please check your credentials."),p(!1)}};return e.jsxs(T,{component:"main",maxWidth:"sm",children:[e.jsxs(F,{elevation:3,sx:{mt:8,p:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(k,{sx:{m:1,bgcolor:"primary.main"},children:e.jsx("img",{src:"/TrafficJamz.ico",alt:"TrafficJamz",style:{width:48,height:48}})}),e.jsx(v,{component:"h1",variant:"h5",children:"Sign in"}),h&&e.jsx(B,{severity:"error",sx:{width:"100%",mt:2},children:h}),e.jsxs(b,{component:"form",onSubmit:L,sx:{mt:1,width:"100%"},children:[e.jsx(w,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,value:o,onChange:t=>A(t.target.value)}),e.jsx(w,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:s,onChange:t=>C(t.target.value)}),e.jsx(D,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:u,children:u?e.jsx(W,{size:24}):"Sign In"}),e.jsxs(m,{container:!0,spacing:3,sx:{justifyContent:"center",alignItems:"center"},children:[e.jsx(m,{item:!0,xs:!0,children:e.jsx(d,{component:y,to:"/forgot-password",variant:"body2",children:"Forgot my password?"})}),e.jsx(m,{item:!0,xs:!0,children:e.jsx(d,{component:y,to:"/auth/register",state:{from:(x=l.state)==null?void 0:x.from},variant:"body2",children:"Don't have an account? Sign Up"})})]})]})]}),e.jsx(b,{mt:4,children:e.jsxs(v,{variant:"body2",color:"text.secondary",align:"center",children:["Copyright Â© ",e.jsx(d,{color:"inherit",href:"#",children:"Audio Group Communication App"})," ",new Date().getFullYear(),"."]})})]})};export{K as default};
