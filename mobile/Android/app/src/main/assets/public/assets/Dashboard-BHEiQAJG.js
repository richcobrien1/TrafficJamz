import{r as i,c as de,j as e,d as W,e as T,u as pe,a as ue,i as A}from"./index-C_3tyMlA.js";import{a as he,g as xe,s as me,c as ge,r as fe,m as F,b as je,B as p,T as u,P as q}from"./Box-B7n4D01-.js";import{A as be,T as ve,L as G,a as I,D as J}from"./Toolbar-C16-zNA2.js";import{a as Ce,c as B,I as N,L as ye,C as Y,B as w}from"./List-K2ODHGaJ.js";import{B as we,D as ke}from"./Drawer-CLSZ2vVr.js";import{N as ze}from"./Notifications-4kvzrTaZ.js";import{M as Ge,T as K}from"./TextField-BEOKNznX.js";import{M as Q}from"./MenuItem-DqvXe7tw.js";import{L as S}from"./ListItemAvatar-mpGPWVKz.js";import{A as k}from"./Avatar-CTdIBAVi.js";import{G as Ie}from"./Group-D4Q33rLV.js";import{L as Se,M as De}from"./Mic-DmEc21pb.js";import{C as Le}from"./Container-BLhiYW-S.js";import{A as X}from"./Grow-5OE428Pa.js";import{G as Z}from"./Grid-CyXsRVxX.js";import{L as Me}from"./LocationOn-CXBPx9JF.js";import{D as Ae,a as Fe,b as Ne,c as Te}from"./DialogTitle-CyEuKmcp.js";import"./mergeSlotProps-COfFLBTA.js";import"./listItemIconClasses-BIGm1TVN.js";function Be(o){return xe("MuiFab",o)}const U=he("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]),Pe=o=>{const{color:a,variant:t,classes:n,size:h}=o,g={root:["root",t,`size${T(h)}`,a==="inherit"?"colorInherit":a]},f=ge(g,Be,n);return{...n,...f}},Re=me(Ce,{name:"MuiFab",slot:"Root",shouldForwardProp:o=>fe(o)||o==="classes",overridesResolver:(o,a)=>{const{ownerState:t}=o;return[a.root,a[t.variant],a[`size${T(t.size)}`],t.color==="inherit"&&a.colorInherit,a[T(t.size)],a[t.color]]}})(F(({theme:o})=>{var a,t;return{...o.typography.button,minHeight:36,transition:o.transitions.create(["background-color","box-shadow","border-color"],{duration:o.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(o.vars||o).zIndex.fab,boxShadow:(o.vars||o).shadows[6],"&:active":{boxShadow:(o.vars||o).shadows[12]},color:o.vars?o.vars.palette.grey[900]:(t=(a=o.palette).getContrastText)==null?void 0:t.call(a,o.palette.grey[300]),backgroundColor:(o.vars||o).palette.grey[300],"&:hover":{backgroundColor:(o.vars||o).palette.grey.A100,"@media (hover: none)":{backgroundColor:(o.vars||o).palette.grey[300]},textDecoration:"none"},[`&.${U.focusVisible}`]:{boxShadow:(o.vars||o).shadows[6]},variants:[{props:{size:"small"},style:{width:40,height:40}},{props:{size:"medium"},style:{width:48,height:48}},{props:{variant:"extended"},style:{borderRadius:48/2,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48}},{props:{variant:"extended",size:"small"},style:{width:"auto",padding:"0 8px",borderRadius:34/2,minWidth:34,height:34}},{props:{variant:"extended",size:"medium"},style:{width:"auto",padding:"0 16px",borderRadius:40/2,minWidth:40,height:40}},{props:{color:"inherit"},style:{color:"inherit"}}]}}),F(({theme:o})=>({variants:[...Object.entries(o.palette).filter(je(["dark","contrastText"])).map(([a])=>({props:{color:a},style:{color:(o.vars||o).palette[a].contrastText,backgroundColor:(o.vars||o).palette[a].main,"&:hover":{backgroundColor:(o.vars||o).palette[a].dark,"@media (hover: none)":{backgroundColor:(o.vars||o).palette[a].main}}}}))]})),F(({theme:o})=>({[`&.${U.disabled}`]:{color:(o.vars||o).palette.action.disabled,boxShadow:(o.vars||o).shadows[0],backgroundColor:(o.vars||o).palette.action.disabledBackground}}))),Ee=i.forwardRef(function(a,t){const n=de({props:a,name:"MuiFab"}),{children:h,className:g,color:f="default",component:x="button",disabled:j=!1,disableFocusRipple:b=!1,focusVisibleClassName:D,size:l="large",variant:v="circular",...z}=n,C={...n,color:f,component:x,disabled:j,disableFocusRipple:b,size:l,variant:v},m=Pe(C);return e.jsx(Re,{className:W(m.root,g),component:x,disabled:j,focusRipple:!b,focusVisibleClassName:W(m.focusVisible,D),ownerState:C,ref:t,...z,classes:m,children:h})}),ee=B(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6m0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20"})),oe=B(e.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"})),$e=B(e.jsx("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"})),io=()=>{var O,H;const[o,a]=i.useState([]),[t,n]=i.useState(!0),[h,g]=i.useState(""),[f,x]=i.useState(!1),[j,b]=i.useState(null),[D,l]=i.useState(!1),[v,z]=i.useState(""),[C,m]=i.useState(""),[P,R]=i.useState(!1),[E,L]=i.useState(""),[M,re]=i.useState([]),{currentUser:s,logout:ae}=pe(),c=ue();i.useEffect(()=>{se(),$()},[]);const se=async()=>{try{n(!0);const r=await A.get("/groups");a(r.data.groups),g("")}catch(r){console.error("Error fetching groups:",r)}finally{n(!1)}},$=async()=>{try{const r=await A.get("/notifications/unread");re(r.data.notifications)}catch(r){console.error("Error fetching notifications:",r)}},te=r=>b(r.currentTarget),V=()=>b(null),_=()=>{ae(),c("/auth/login")},ie=async()=>{var r,y;if(!v.trim()){L("Group name is required");return}try{R(!0),L("");const d=await A.post("/groups",{group_name:v,group_description:C});a(ce=>[...ce,d.data.group]),l(!1),z(""),m("")}catch(d){L(((y=(r=d.response)==null?void 0:r.data)==null?void 0:y.message)||"Failed to create group. Please try again.")}finally{R(!1)}},ne=r=>c(`/groups/${r}`),le=!!j;return e.jsxs(p,{sx:{display:"flex",flexDirection:"column",minHeight:"100vh"},children:[e.jsx(be,{position:"static",children:e.jsxs(ve,{children:[e.jsx(N,{edge:"start",color:"inherit","aria-label":"open drawer",sx:{mr:2},onClick:()=>x(!0),children:e.jsx($e,{})}),e.jsx(u,{variant:"h6",component:"div",sx:{flexGrow:1},children:"Groups"}),e.jsx(N,{color:"inherit",onClick:$,"aria-label":"refresh notifications",children:e.jsx(we,{badgeContent:M==null?void 0:M.length,color:"error",children:e.jsx(ze,{})})}),e.jsx(N,{edge:"end","aria-label":"account menu","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:te,color:"inherit",children:e.jsx(ee,{})})]})}),e.jsxs(Ge,{id:"menu-appbar",anchorEl:j,open:le,onClose:V,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsx(Q,{onClick:()=>{V(),c("/profile")},children:"Profile"}),e.jsx(Q,{onClick:_,children:"Logout"})]}),e.jsx(ke,{anchor:"left",open:f,onClose:()=>x(!1),children:e.jsx(p,{sx:{width:250},role:"presentation",onClick:()=>x(!1),children:e.jsxs(ye,{children:[e.jsxs(G,{children:[e.jsx(S,{children:e.jsx(k,{src:s==null?void 0:s.profile_image_url,children:((O=s==null?void 0:s.first_name)==null?void 0:O[0])||((H=s==null?void 0:s.username)==null?void 0:H[0])})}),e.jsx(I,{primary:`${(s==null?void 0:s.first_name)||""} ${(s==null?void 0:s.last_name)||""}`,secondary:s==null?void 0:s.email})]}),e.jsx(J,{}),e.jsxs(G,{component:"button",onClick:()=>c("/"),children:[e.jsx(S,{children:e.jsx(k,{children:e.jsx(Ie,{})})}),e.jsx(I,{primary:"Groups"})]}),e.jsxs(G,{component:"button",onClick:()=>c("/profile"),children:[e.jsx(S,{children:e.jsx(k,{children:e.jsx(ee,{})})}),e.jsx(I,{primary:"Profile"})]}),e.jsx(J,{}),e.jsxs(G,{component:"button",onClick:_,children:[e.jsx(S,{children:e.jsx(k,{children:e.jsx(Se,{})})}),e.jsx(I,{primary:"Logout"})]})]})})}),e.jsxs(Le,{component:"main",sx:{flexGrow:1,py:4},children:[e.jsxs(p,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsx(u,{variant:"h4",component:"h1",children:"Your TrafficJamz Groups"}),e.jsx(Ee,{color:"primary","aria-label":"create new group",onClick:()=>l(!0),children:e.jsx(oe,{})})]}),h&&e.jsx(X,{severity:"error",sx:{mb:3},children:h}),t?e.jsx(p,{sx:{display:"flex",justifyContent:"center",my:4},children:e.jsx(Y,{})}):(o==null?void 0:o.length)===0?e.jsxs(q,{sx:{p:4,textAlign:"center"},children:[e.jsx(u,{variant:"h6",gutterBottom:!0,children:"You don't have any groups yet"}),e.jsx(u,{variant:"body1",color:"text.secondary",paragraph:!0,children:"Create a new group to start communicating with your friends"}),e.jsx(w,{variant:"contained",startIcon:e.jsx(oe,{}),onClick:()=>l(!0),children:"Create Group"})]}):e.jsx(Z,{container:!0,spacing:3,children:o.map(r=>{var y;return e.jsx(Z,{item:!0,size:{xs:12,sm:6,md:4},children:e.jsxs(q,{sx:{p:3,display:"flex",flexDirection:"column",height:"100%",cursor:"pointer","&:hover":{boxShadow:6}},onClick:()=>ne(r.id),children:[e.jsxs(p,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(k,{src:r.avatar_url,sx:{width:56,height:56,mr:2},children:r.name[0]}),e.jsxs(p,{children:[e.jsx(u,{variant:"h6",children:r.name}),e.jsxs(u,{variant:"body2",color:"text.secondary",children:[((y=r.members)==null?void 0:y.length)||0," members"]})]})]}),r.description&&e.jsx(u,{variant:"body2",sx:{mb:2,flexGrow:1},children:r.description}),e.jsxs(p,{sx:{display:"flex",justifyContent:"space-between",mt:"auto",gap:1},children:[e.jsx(w,{variant:"outlined",size:"small",startIcon:e.jsx(De,{}),onClick:d=>{d.stopPropagation(),c(`/audio-session/${r.id}`)},children:"Join Audio"}),e.jsx(w,{variant:"outlined",size:"small",startIcon:e.jsx(Me,{}),onClick:d=>{d.stopPropagation(),c(`/location-tracking/${r.id}`)},children:"Location"})]})]})},r.id)})})]}),e.jsxs(Ae,{open:D,onClose:()=>l(!1),"aria-labelledby":"create-group-dialog",children:[e.jsx(Fe,{id:"create-group-dialog",children:"Create New Group"}),e.jsxs(Ne,{children:[E&&e.jsx(X,{severity:"error",sx:{mb:2},children:E}),e.jsx(K,{autoFocus:!0,margin:"dense",id:"group-name",label:"Group Name",type:"text",fullWidth:!0,variant:"outlined",value:v,onChange:r=>z(r.target.value),required:!0,"aria-required":"true"}),e.jsx(K,{margin:"dense",id:"group-description",label:"Description (optional)",type:"text",fullWidth:!0,variant:"outlined",multiline:!0,rows:3,value:C,onChange:r=>m(r.target.value)})]}),e.jsxs(Te,{children:[e.jsx(w,{onClick:()=>l(!1),children:"Cancel"}),e.jsx(w,{onClick:ie,variant:"contained",disabled:P,"aria-label":"submit new group",children:P?e.jsx(Y,{size:24}):"Create"})]})]})]})};export{io as default};
